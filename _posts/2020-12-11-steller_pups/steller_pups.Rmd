---
title: "Site attendance visualization"
description: |
  of Steller sea lion pups in five Alaska rookeries
author:
  - name: Grace Kumaishi
date: 12-11-2020
output:
  distill::distill_article:
    self_contained: false
    code_folding: Code
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
library(tidyverse)
library(here)
library(janitor)
library(plotly)
```

```{r}
# Read in the data:
pups <- read.csv(here("data", "steller_pups.csv")) %>% 
  clean_names()

# Write a code to find the mean value by site and year, so that for each site and year there is only a single (mean) value wherever there were multiple estimates from different sites.
pup_counts <- pups %>% 
  group_by(sitename, year) %>% 
  summarize(mean_count = mean(pupcount)) %>% 
  filter(sitename %in% c("Sugarloaf", "Marmot", "Forrester Complex", "Chowiet", "Hazy")) %>% # filter to only keep certain sites
  rename(steller_pups = mean_count) # rename column, remember that old column name goes second, not first!!! 

# Create a finalized graph
average_counts <- 
  ggplot(data = pup_counts) +
  geom_line(aes(x = year, y = steller_pups), size = .7, color = "dodgerblue3") +
  facet_wrap(~sitename) +
  scale_x_continuous(breaks = c(1970, 1990, 2010)) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(x = "Year",
       y = "Average pup count",
       title = "Average counts of Steller Sea Lion pups at five Alaska rookeries") +
  theme(legend.position = "none") +
  geom_point(aes(x = year, y = steller_pups), color = "dodgerblue3", alpha = 0.8)

ggplotly(average_counts)
```

**Figure 1:** Average counts of Steller Sea Lion (*Eumetopias jubatus*) pups observed at five rookeries in Alaska between 1961 and 2015. Data points indicate years in which counts were available and are connected by line segments to visualize overall trends between sites. Average counts by year can be seen by hovering over individual data points. (Data: Fritz et al. 2015).

### Notable trends:

Counts at Chowiet, Marmot, and Sugarloaf have declined in the past few decades, with most recent pup counts falling under 1000 average individuals per site. Forrester Complex saw an increase in pups counted after the initial count in 1961, but counts fell to zero between 1998 and 2002, indicating site failure. Hazy is the only site that has increased average pup counts since the initial pup count in 1979, with an average of 1994.5 pups counted in 2015. 

### Citation:

[Fritz, Lowell; Sweeney, Kathryn; Lynn, Morgan; Gelatt, Thomas; Gilpatrick, James; Towell, Rodney (2015). Counts of Alaska Steller sea lion pups conducted on rookeries in Alaska from 1961-06-22 to 2015-07-18 (NCEI Accession 0128189). NOAA National Centers for Environmental Information. Dataset.](https://doi.org/10.7289/v5862ddr. Accessed 2020-12-04.)


